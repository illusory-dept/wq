primes:{[n]j:til(n+1);p:j>1;limit:floor sqrt n;i:2;W[i<=limit;$[p[i];start:i*i;rem:(j-start)/i;comp:and[rem=floor rem;j>=start;];p:and[p;not comp;];];i:i+1;];where p}
